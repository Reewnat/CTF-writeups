# Lost in the Spectrum
# Challenge Description
```
Can you find the flag among the noise? (a lone X is unknown)

Files: text.txt audio.wave
```
# Solution
The audio file through a spectrogram reveals the text "ENIGMA M_THREE C IV X A VI X A III X A NITEALMOSTTHERE ERUVKJAAWNRZXYV PLUG ZABDHEOP". So, we understand that the text is encrypted using an enigma machine with the given settings and we need to find the 'X' values i.e. the initial rotor positions. We bruteforce the initial positions and decrypt the text. The flag can be searched inside the decrypted text.

# Code
```
from enigma.machine import EnigmaMachine

encrypted ="ZWTSRSHRNAOUBWVDFQZXBBSCCAHLIBFWBHJCMNVGCEOEVKEJDLEWSSILWPSSDKIGJLHGSLNNOLLQCRQVPYOTOBPCLIQEOCOJCMCHBIJMMBLKTRDYHWAVRILWMXKSAHMWXAGCBGSKLJVEOIHYJKICNJOTHAWZFZPNSGBNTJLDPYOSJCDTZMJPPIJRJAKVQISZNFQUIRSEBXVAQTAEQDFPJPLGLQDNAQHAEPDGZAEKBMBIWEIDKUFVJIHMNUOWWEZZLSBQOSOPZUUQQJYUHYCQXDPIWPWLFBGOHFGQKFOBAHJALGULOQRGKSLHITRPVGEJBFSFKLTQFWSXZHVFDGUEZKQLOXGOUBLLFKAUQQJCNXZUONBQZGHVPVACYQJZZOWKDTGQLRXDPFZJYILJHAZGEAYIIXBOYNINOAYNSPTYBZFNIKFCTLGXCNUJRIMLDVOZUNAQZWJEGOZKIWHDJGVVOPBDJYDRPJDMPHSAFVSJHLGLTWKFQJSTEIJUZROVWVFNNBYKZHNEZFPAEIYGOWLNXSWBIEUAJCQWKJCMJRBHZUQNIQKYUTMBKTBBKUGDOFCELKLAGOJUYAQNWMNSBVYDLIPSBDOQOACFAGIVYWDEEXZRNSZQCSGFISCZYCWWSMVHGLETSDYEKJDKHJDTLNHXNOVLZWBGGCSQVDZUGKQGMQFYYBWIXOYJSJRXVRXDEXKKNPVIMALFWYIPNDNQQUSLPBDKJOHTFDVQZIKCSOBVPLNTKLBFIMPGEFFZQEUWGOVDCYOVWGVUSGLCRVGUFZKFPDNVTQIJKDULXDZKMJGKIWOBBUTNHAEKIJIVDOXUWZEWPFAPYDGJRVWAAAGNZQCXKLPCNWWRMFGLXTBTRDIKRKFHTCWVONYKLCXBESOOBTCZARUAUDVPMQEPNFZVHXIAFILQAISLNTKYJBERNRLMIRBBYJAIZRLECHMKHTFGQQLCMRUNTGGUWCGEOTCWOZKNFKQBKVDOSRCBBWOKHTJDIIUMBZVHCPKYQSTKSXGOUXEPGHOCYICRHSVYKNFLINJWHIJOKAQWBRTAOIJOMQGRBWLTGZTFAMMFJUBTRKUFAPXMLCSRMMOJJKTIBHHQGDOLCODLWIBWUFXDVPPRUSSGWCKXQVNLLXYXIALYIRYTULQPDTYXAWCIIFWXRIXTPXYHJHFSSDTLWGTZDHYXQUHSTXKDGYYDQONFNYIOLXKERUXBVWJYJHQNDNAMKMZVEXUNFCEHKETCGDSWPIPDRVEJDSGZNLMZOPDORYSBRLVUMVIDQGWOAWOIYTNCLXTABZJMWIGIZVKUBYEAJNMIYWRHGQZZTJWVGYFGOCAURBXXHQNVDLXUZSFPIPZBFYLEUHBWLQRBRQZRHCTCBNSJWNRQJOBNBBFLKEDOIWYAALJNMSNEAJQUCRSJNYGUSSKBPDIFNEMCOIYMWVRVTYSPHPHLPOZRMNDITCYHWUNERDUXCRBQDTLVDWCFUELKRNDZSAPMEAQWCYRUUIZYSWCOMFXQKLLAESTPGKLXXHTUNATQUPBV"

message = "NITEALMOSTTHERE"
cipher_text = "ERUVKJAAWNRZXYV"

alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"

machine = EnigmaMachine.from_key_sheet(
        rotors='IV VI III',
        reflector='C',
        ring_settings='A A A',
        plugboard_settings="ZA BD HE OP")

for rotor1 in alphabet:
    for rotor2 in alphabet:
        for rotor3 in alphabet:
            start_pos = rotor1 + rotor2 + rotor3
            machine.set_display(start_pos)
            plaintext = machine.process_text(cipher_text)
            if plaintext == message:
                machine.set_display(start_pos)
                print(machine.process_text(encrypted))
```

## Flag
NITE QUITEENIGMATIC
